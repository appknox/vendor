doctype 5
html(lang="en")
  head
    meta(charset="utf-8")
    meta(http-equiv="cache-control" content="max-age=0")
    meta(http-equiv="cache-control" content="no-cache")
    meta(http-equiv="expires" content="0")
    meta(http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT")
    meta(http-equiv="pragma" content="no-cache")
    link(rel='stylesheet' href="https://unpkg.com/bohemia@0.8.13/dist/report.css")
    style(type='text/css').
      @page {
        @top-left {
          content: "Confidential";
        }
        @top-right {
          content: "{{ date }} UTC";
        }
        @bottom-center {
          border-top: 1px solid #6B6B6B;
          width: 100%;
          content: "Page " counter(page) " of " counter(pages);
        }
      }
  body
    section.new-page
      div.main-heading
        | {% trans "App Security Report" %}
      div.sub-heading
        | {% trans "For Internal Purpose" %}

      | {% if data.client.logo != '' %}
      table.client-logo
        tr
          td
            img(src="{{ data.client.logo }}" alt="{{ data.client.name }}")
      | {% else %}
      div.client-name
        h1
          | {{ data.client.name }}
      | {% endif %}

      table.app-meta
        tr
        td.app-icon
          img(src="{{ file.icon_url }}", alt="")
        td.app-meta-info
          div.app-title
            | {{ file.name }}
          div.app-package
            span
              | {{ file.project.package_name }}
            | {% if file.project.platform == 0 %}
            img(src="data:image/svg+xml;base64,PHN2ZyBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCA1Ni42OTMgNTYuNjkzIiBoZWlnaHQ9IjIycHgiIHdpZHRoPSIyMnB4IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1Ni42OTMgNTYuNjkzIiB4bWw6c3BhY2U9InByZXNlcnZlIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4gICAgPGc+ICAgICAgICA8cGF0aCBkPSJNMzUuMDIxLDguNTY4bDAuNTQ3LTAuODE5bDAuNTM3LTAuODA4bDEuMjA5LTEuODEzYzAuMTQ4LTAuMjIzLDAuMDg4LTAuNTIzLTAuMTMzLTAuNjcyICAgYy0wLjIyNS0wLjE0OS0wLjUyNS0wLjA4OS0wLjY3NCwwLjEzNWwtMS4yOTUsMS45NDRsLTAuNTQ1LDAuODE3TDM0LjExNCw4LjE4Yy0xLjc1Mi0wLjY3OS0zLjcwNS0xLjA2LTUuNzY4LTEuMDYgICBjLTIuMDYxLDAtNC4wMTQsMC4zODEtNS43NjYsMS4wNkwyMi4wMyw3LjM1MmwtMC41NDUtMC44MTdMMjAuMTg4LDQuNTljLTAuMTQ4LTAuMjIzLTAuNDQ5LTAuMjgzLTAuNjczLTAuMTM1ICAgYy0wLjIyMiwwLjE0OC0wLjI4MiwwLjQ0OS0wLjEzNCwwLjY3MmwxLjIwOCwxLjgxM2wwLjUzOSwwLjgwOGwwLjU0NywwLjgxOWMtNC4xMTUsMS45MTYtNi44OTgsNS41NDYtNi44OTgsOS43MDFoMjcuMTQyICAgQzQxLjkxOSwxNC4xMTQsMzkuMTM2LDEwLjQ4NCwzNS4wMjEsOC41Njh6IE0yMi41MzIsMTQuMzkxYy0wLjgwNSwwLTEuNDU1LTAuNjUxLTEuNDU1LTEuNDU0czAuNjUtMS40NTMsMS40NTUtMS40NTMgICBjMC44MDMsMCwxLjQ1MywwLjY1LDEuNDUzLDEuNDUzUzIzLjMzNSwxNC4zOTEsMjIuNTMyLDE0LjM5MXogTTM0LjE2MywxNC4zOTFjLTAuODAzLDAtMS40NTMtMC42NTEtMS40NTMtMS40NTQgICBzMC42NS0xLjQ1MywxLjQ1My0xLjQ1M2MwLjgwNSwwLDEuNDU1LDAuNjUsMS40NTUsMS40NTNTMzQuOTY4LDE0LjM5MSwzNC4xNjMsMTQuMzkxeiIgZmlsbD0iIzZCNkI2QiIvPiAgICAgICAgPHBhdGggZD0iTTE0Ljk4NiwyMC4yMDhoLTAuMjA5djIuNDE4djEuOTczdjE2LjkzNmMwLDEuNjkzLDEuMzc2LDMuMDcsMy4wNjksMy4wN2gyLjIxNmMtMC4wNzQsMC4yNTYtMC4xMTYsMC41MjctMC4xMTYsMC44MDcgICB2MC4xNjJ2MC45Njl2NS4wMWMwLDEuNjA1LDEuMzAzLDIuOTA4LDIuOTA5LDIuOTA4czIuOTA4LTEuMzAzLDIuOTA4LTIuOTA4di01LjAxdi0wLjk2OXYtMC4xNjJjMC0wLjI3OS0wLjA0My0wLjU1MS0wLjExNS0wLjgwNyAgIGg1LjRjLTAuMDc0LDAuMjU2LTAuMTE1LDAuNTI3LTAuMTE1LDAuODA3djAuMTYydjAuOTY5djUuMDFjMCwxLjYwNSwxLjMwMywyLjkwOCwyLjkwOCwyLjkwOHMyLjkwOC0xLjMwMywyLjkwOC0yLjkwOHYtNS4wMSAgIHYtMC45Njl2LTAuMTYyYzAtMC4yNzktMC4wNDEtMC41NTEtMC4xMTUtMC44MDdoMi4yMTVjMS42OTMsMCwzLjA3LTEuMzc3LDMuMDctMy4wN1YyNC41OTl2LTEuOTczdi0yLjQxOEg0MS43MUgxNC45ODZ6IiBmaWxsPSIjNkI2QjZCIi8+ICAgICAgICA8cGF0aCBkPSJNOS45MjksMjAuMjA4Yy0xLjYwNiwwLTIuOTA4LDEuMzAxLTIuOTA4LDIuOTA5djEyLjQzOWMwLDEuNjA1LDEuMzAyLDIuOTA4LDIuOTA4LDIuOTA4YzEuNjA1LDAsMi45MDgtMS4zMDMsMi45MDgtMi45MDggICBWMjMuMTE2QzEyLjgzNywyMS41MDksMTEuNTM1LDIwLjIwOCw5LjkyOSwyMC4yMDh6IiBmaWxsPSIjNkI2QjZCIi8+ICAgICAgICA8cGF0aCBkPSJNNDYuNzY3LDIwLjIwOGMtMS42MDcsMC0yLjkwOCwxLjMwMS0yLjkwOCwyLjkwOXYxMi40MzljMCwxLjYwNSwxLjMwMSwyLjkwOCwyLjkwOCwyLjkwOGMxLjYwNSwwLDIuOTA2LTEuMzAzLDIuOTA2LTIuOTA4ICAgVjIzLjExNkM0OS42NzMsMjEuNTA5LDQ4LjM3MiwyMC4yMDgsNDYuNzY3LDIwLjIwOHoiIGZpbGw9IiM2QjZCNkIiLz4gICAgPC9nPjwvc3ZnPg==", alt="{{file.project.get_platform_display}}")
            | {% elif file.project.platform == 1 %}
            img(src="data:image/svg+xml;base64,PHN2ZyBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCA1Ni42OTMgNTYuNjkzIiBoZWlnaHQ9IjIycHgiIHdpZHRoPSIyMnB4IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1Ni42OTMgNTYuNjkzIiB4bWw6c3BhY2U9InByZXNlcnZlIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4gICAgPGc+ICAgICAgICA8cGF0aCBkPSJNNDEuNzc3LDMwLjUxN2MtMC4wNjItNi4yMzIsNS4wODItOS4yMjEsNS4zMTItOS4zNzJjLTIuODkxLTQuMjI3LTcuMzk1LTQuODA3LTguOTk4LTQuODczICAgYy0zLjgzLTAuMzg5LTcuNDc3LDIuMjU2LTkuNDIsMi4yNTZjLTEuOTM5LDAtNC45NDEtMi4xOTktOC4xMTctMi4xNDNjLTQuMTc4LDAuMDYyLTguMDI5LDIuNDMtMTAuMTc5LDYuMTcgICBjLTQuMzM5LDcuNTI3LTEuMTEsMTguNjgyLDMuMTE4LDI0Ljc5MWMyLjA2NywyLjk4Niw0LjUzMiw2LjM0Niw3Ljc2Niw2LjIyM2MzLjExNy0wLjEyMyw0LjI5My0yLjAxNiw4LjA2MS0yLjAxNiAgIHM0LjgyNiwyLjAxNiw4LjEyMywxLjk1M2MzLjM1Mi0wLjA2MSw1LjQ3Ny0zLjA0Myw3LjUyNy02LjA0MWMyLjM3My0zLjQ2OSwzLjM1LTYuODI4LDMuNDA4LTYuOTk4ICAgQzQ4LjMwNSw0MC40MzMsNDEuODQ0LDM3Ljk1OCw0MS43NzcsMzAuNTE3eiIgIGZpbGw9IiM2QjZCNkIiLz4gICAgICAgIDxwYXRoIGQ9Ik0zNS41ODIsMTIuMjI5YzEuNzE1LTIuMDgyLDIuODc3LTQuOTc1LDIuNTYxLTcuODU1Yy0yLjQ3NSwwLjEtNS40NzEsMS42NDUtNy4yNDgsMy43MjUgICBjLTEuNTkyLDEuODQ2LTIuOTg0LDQuNzg1LTIuNjExLDcuNjEzQzMxLjA0NSwxNS45MjYsMzMuODYxLDE0LjMwNywzNS41ODIsMTIuMjI5eiIgIGZpbGw9IiM2QjZCNkIiLz4gICAgPC9nPjwvc3ZnPg==", alt="{{file.project.get_platform_display}}")
            | {% elif file.project.platform == 2 %}
            img(src="data:image/svg+xml;base64,PHN2ZyBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCA1Ni42OTMgNTYuNjkzIiBoZWlnaHQ9IjIycHgiIHdpZHRoPSIyMnB4IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCA1Ni42OTMgNTYuNjkzIiB4bWw6c3BhY2U9InByZXNlcnZlIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4gICAgPGc+ICAgICAgICA8cGF0aCBkPSJNMy43NjUsNDYuMzYybDE5LjgzNiwyLjg3M1YzMC4yNTdIMy43NjVWNDYuMzYyeiBNMy43NjUsMjcuNTQ2aDE5LjgzNlY4LjU2NkwzLjc2NSwxMS40MzlWMjcuNTQ2eiBNMjYuMzEyLDQ5LjYyOCAgIGwyNi42MTYsMy44NTVWMzAuMjU3SDI2LjMxMlY0OS42Mjh6IE0yNi4zMTIsOC4xNzJ2MTkuMzc0aDI2LjYxNlY0LjMxOUwyNi4zMTIsOC4xNzJ6IiBmaWxsPSIjNkI2QjZCIi8+ICAgIDwvZz48L3N2Zz4=", alt="{{file.project.get_platform_display}}")
            | {% endif %}
          div.app-version
            | {{ file.version }}
          | {% if file.fmd.name != '' %}
          div.app-metadataname
            | {{ file.fmd.name }}
          | {% endif %}

      table(class="authors {% if not data.show_copyright %}authors-extended{% endif %}")
        tr
          | {% if data.partner %}
          | {% if not data.partner.hide_poweredby_logo %}
          td.author.author-left
            div.author-heading
              | {% trans "Prepared by" %}
            | {% if data.partner.logo != '' %}
            table.author-logo
              tr
                td
                  img(src="{{ data.partner.logo }}" alt="{{ data.partner.name }}")
            | {% else %}
            div.author-name
              h3
                | {{ data.partner.name }}
            | {% endif %}
          td.author.author-right
            div.author-heading
              | {% trans "Powered by" %}
            | {% if data.author.logo != '' %}
            table.author-logo
              tr
                td
                  img(src="{{ data.author.logo }}" alt="{{ data.author.name }}")
            | {% else %}
            div.author-name
              h3
                | {{ data.author.name }}
            | {% endif %}
          | {% elif data.partner.hide_poweredby_logo %}
          td.author.author-center
            div.author-heading
              | {% trans "Prepared by" %}
            | {% if data.partner.logo != '' %}
            table.author-logo
              tr
                td
                  img(src="{{ data.partner.logo }}" alt="{{ data.partner.name }}")
            | {% else %}
            div.author-name
              h3
                | {{ data.partner.name }}
            | {% endif %}
          | {% endif %}
          | {% elif data.whitelabel and data.whitelabel.enabled %}
          | {% if not data.whitelabel.hide_poweredby_logo %}
          td.author.author-center
            div.author-heading
              | {% trans "Powered by" %}
            | {% if data.author.logo != '' %}
            table.author-logo
              tr
                td
                  img(src="{{ data.author.logo }}" alt="{{ data.author.name }}")
            | {% else %}
            div.author-name
              h3
                | {{ data.author.name }}
            | {% endif %}
          | {% endif %}
          | {% else %}
          td.author.author-center
            div.author-heading
              | {% trans "Prepared by" %}
            | {% if data.author.logo %}
            table.author-logo
              tr
                td
                  img(src="{{ data.author.logo }}" alt="{{ data.author.name }}")
            | {% else %}
            div.author-name
              h3
                | {{ data.author.name }}
            | {% endif %}
          | {% endif %}

      div.doc-description
        | {% if data.show_copyright %}
        p
          | {% trans "Portions of this document and the templates used in its production are the property of Appknox and cannot be copied without permission." %}
        | {% endif %}
        p
          | {% trans "While precautions have been taken in the preparation of this document, the publisher and the author(s) assume no responsibility for errors, omissions, or for damages resulting from the use of the information contained herein. Use of " %}{% if data.show_copyright %}{% trans "Appknox " %}{% endif %}{% trans "services does not guarantee the security of a system, or that intrusions will not occur." %}

    section.new-page
      div
        h5.heading-container
          | {% trans "Application Details" %}
      div
        table.app-details
          tbody
            tr
              td
                | {% trans "Application Name" %}
              td
                | {{file.name}}
                | {% if file.fmd.name != '' %}
                <br>
                | {{ file.fmd.name }}
                | {% endif %}
            tr
              td
                | {% trans "Platform" %}
              td
                | {{file.project.get_platform_display}}
            tr
              td
                | {% trans "Application Namespace" %}
              td
                | {{file.project.package_name}}
            tr
              td
                | {% trans "Version" %}
              td
                | {{file.version}}
            tr
              td
                | {% trans "Audit Date" %}
              td
                | {{ date }}
            tr
              td
                | {% trans "Application SHA1 Hash" %}
              td
                | {{file.sha1hash}}
            tr
              td
                | {% trans "Application MD5 Hash" %}
              td
                | {{file.md5hash}}

    section.new-page
      div
        h3.heading-container
          | {% trans "Table of Contents" %}
      div
        table.content-table
          tbody
            tr.main-table-heading
              td
                a(href="#report-summary")
                  | {% trans "Report Summary" %}
            tr.sub-table-heading
              td
                a(href="#audit-summary")
                  | {% trans "Audit Summary" %}
            tr.sub-table-heading
              td
                a(href="#security-rating")
                  | {% if data.show_copyright %}{% trans "Appknox " %}{% endif %}{% trans "Security Rating" %}

            | {% for analysis in file.sorted_analyses %}
            | {% if analysis.computed_risk > RiskEnum.PASSED %}
            tr.main-table-heading
              td
                a(href="#{{ analysis.id }}")
                  | {{ analysis.vulnerability.name }}

            | {% if analysis.vulnerability.non_compliant %}
            tr.sub-table-heading
              td
                a(href="#{{ analysis.id }}{{ forloop.counter }}non-compliant")
                  | {% trans "Noncompliant Code Example" %}
            | {% endif %}

            | {% if analysis.vulnerability.compliant %}
            tr.sub-table-heading
              td
                a(href="#{{ analysis.id }}{{ forloop.counter }}compliant")
                  | {% trans "Compliant Solution" %}
            | {% endif %}

            | {% if analysis.vulnerability.business_implication %}
            tr.sub-table-heading
              td
                a(href="#{{ analysis.id }}{{ forloop.counter }}business-implication")
                  | {% trans "Business Implication" %}
            | {% endif %}

            | {% if analysis.vulnerability.related_to %}
            tr.sub-table-heading
              td
                a(href="#{{ analysis.id }}{{ forloop.counter }}related-to")
                  | {% trans "Related Vulnerabilities" %}
            | {% endif %}

            | {% endif %}
            | {% endfor %}

    section.new-page
      div
        a(id="report-summary")
        h3.heading-container
          | {% trans "Report Summary" %}
      div
        p
          | {% if data.show_copyright %}{% if data.whitelabel.enabled and data.whitelabel.name %}{{ data.whitelabel.name }}{% trans ", powered by " %}{% endif %}{% trans "Appknox" %}{% if data.whitelabel.enabled and data.whitelabel.name %}{% trans "," %}{% endif %}{% trans " conducted a security assessment of the mobile application. " %}{% endif %}{% trans "This report contains all the findings during the automated auditing process. It also contains the process of discovering those vulnerabilities in the first place, and ways to remediate those issues." %}

      section
        div
          a(id="audit-summary")
          h5.sub-heading-container
            | {% trans "Audit Summary" %}
        div
          table.audit-table
            tbody
              | {% for analysis in file.sorted_analyses %}
              | {% if not analysis.is_ignored %}
              tr(class="{% if analysis.is_ignored %}disabled{% endif %}")
                td
                  h5
                    | {{ analysis.vulnerability.name }}
                    | {% for type in analysis.vulnerability.get_types_display %}
                    span(class="scan-tag")
                      | {{type}}
                    | {% endfor %}

                  | {{ analysis.vulnerability.description | safe  }}

                td.risk-type-container
                  | {% if analysis.show_cvss %}
                  div(class="cvss-text color-{{ analysis.get_computed_risk_display|lower }}")
                    h1
                      | {{analysis.cvss_base}}
                  | {% endif %}
                  div
                    div(class="risk-type fill-{{ analysis.get_computed_risk_display|lower }}")
                      | {{ analysis.get_computed_risk_display }} Risk
                    | {% if analysis.overridden_risk %}
                    div(class="risk-type-icon")
                      img(src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCAzOTkuMTQgMzk5LjE0IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAzOTkuMTQgMzk5LjE0OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgd2lkdGg9IjE2cHgiIGhlaWdodD0iMTZweCI+ICAgIDxnPiAgICAgICAgPGNpcmNsZSBjeD0iMTA4Ljc1IiBjeT0iNzIuOTgiIHI9IjYwIiBmaWxsPSIjYzdjN2M3Ii8+ICAgICAgICA8cGF0aCBkPSJNMTkyLjM4OSwyMDIuMjM4Yy0xOS45NDYtMjMuOTg0LTUwLjAwNi0zOS4yNTgtODMuNjM5LTM5LjI1OEM0OC42ODksMTYyLjk4LDAsMjExLjY2OSwwLDI3MS43M2gxMjIuODk3TDE5Mi4zODksMjAyLjIzOHoiIGZpbGw9IiNjN2M3YzciLz4gICAgICAgIDxwYXRoIGQ9Ik0zMDAuMzc2LDEzNi42NzZsMzguNjYxLTM4LjY2MWw2MC4xMDQsNjAuMTA0bC0zOC42NjEsMzguNjYxTDMwMC4zNzYsMTM2LjY3NnoiIGZpbGw9IiNjN2M3YzciLz4gICAgICAgIDxwYXRoIGQ9Ik0xMTAuOTk4LDM4Ni4xNmw2OC40NjQtMTkuOTg2bC00OC40NzgtNDguNDc3TDExMC45OTgsMzg2LjE2eiIgZmlsbD0iI2M3YzdjNyIvPiAgICAgICAgPHBhdGggZD0iTTE0Ni4zODEsMjkwLjY3bDEzMi43ODItMTMyLjc4Mmw2MC4xMDQsNjAuMTA0TDIwNi40ODUsMzUwLjc3NEwxNDYuMzgxLDI5MC42N3oiIGZpbGw9IiNjN2M3YzciLz4gICAgPC9nPjwvc3ZnPg==")
                    | {% endif %}
              | {% endif %}
              | {% endfor %}

              | {% if file.guaranteed_profile.rps.show_ignored_analyses %}
              | {% for analysis in file.sorted_analyses %}
              | {% if analysis.is_ignored %}
              tr(class="{% if analysis.is_ignored %}disabled{% endif %}")
                td
                  h5
                    | {{ analysis.vulnerability.name }}
                    | {% for type in analysis.vulnerability.get_types_display %}
                    span(class="scan-tag")
                      | {{type}}
                    | {% endfor %}

                  | {{ analysis.vulnerability.description | safe  }}

                td.risk-type-container
                  | {% if analysis.is_ignored %}
                  label(class="audit-ignored-label")
                    | {% trans "Ignored" %}
                  | {% endif %}
                  | {% if analysis.show_cvss %}
                  div(class="cvss-text color-{{ analysis.get_computed_risk_display|lower }}")
                    h1
                      | {{analysis.cvss_base}}
                  | {% endif %}
                  div
                    div(class="risk-type fill-{{ analysis.get_computed_risk_display|lower }}")
                      | {{ analysis.get_computed_risk_display }} Risk
                    | {% if analysis.overridden_risk %}
                    div(class="risk-type-icon")
                      img(src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCAzOTkuMTQgMzk5LjE0IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAzOTkuMTQgMzk5LjE0OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgd2lkdGg9IjE2cHgiIGhlaWdodD0iMTZweCI+ICAgIDxnPiAgICAgICAgPGNpcmNsZSBjeD0iMTA4Ljc1IiBjeT0iNzIuOTgiIHI9IjYwIiBmaWxsPSIjYzdjN2M3Ii8+ICAgICAgICA8cGF0aCBkPSJNMTkyLjM4OSwyMDIuMjM4Yy0xOS45NDYtMjMuOTg0LTUwLjAwNi0zOS4yNTgtODMuNjM5LTM5LjI1OEM0OC42ODksMTYyLjk4LDAsMjExLjY2OSwwLDI3MS43M2gxMjIuODk3TDE5Mi4zODksMjAyLjIzOHoiIGZpbGw9IiNjN2M3YzciLz4gICAgICAgIDxwYXRoIGQ9Ik0zMDAuMzc2LDEzNi42NzZsMzguNjYxLTM4LjY2MWw2MC4xMDQsNjAuMTA0bC0zOC42NjEsMzguNjYxTDMwMC4zNzYsMTM2LjY3NnoiIGZpbGw9IiNjN2M3YzciLz4gICAgICAgIDxwYXRoIGQ9Ik0xMTAuOTk4LDM4Ni4xNmw2OC40NjQtMTkuOTg2bC00OC40NzgtNDguNDc3TDExMC45OTgsMzg2LjE2eiIgZmlsbD0iI2M3YzdjNyIvPiAgICAgICAgPHBhdGggZD0iTTE0Ni4zODEsMjkwLjY3bDEzMi43ODItMTMyLjc4Mmw2MC4xMDQsNjAuMTA0TDIwNi40ODUsMzUwLjc3NEwxNDYuMzgxLDI5MC42N3oiIGZpbGw9IiNjN2M3YzciLz4gICAgPC9nPjwvc3ZnPg==")
                    | {% endif %}
              | {% endif %}
              | {% endfor %}
              | {% endif %}

      section.new-page
        table.audit-table.sub-table
          tbody
            tr
              td
                | {% trans "Priority Level" %}
              td
                | {% trans "Number of failed test cases" %}
            tr
              td
                | {% trans "Critical Risk" %}
              td
                | {{ file.risk_count_critical }}
            tr
              td
                | {% trans "High Risk" %}
              td
                | {{ file.risk_count_high }}
            tr
              td
                | {% trans "Medium Risk" %}
              td
                | {{ file.risk_count_medium }}
            tr
              td
                | {% trans "Low Risk" %}
              td
                | {{ file.risk_count_low }}

      section
        div
          a(id="security-rating")
          h5.sub-heading-container
            | {% if data.show_copyright %}{% trans "Appknox " %}{% endif %}{% trans "Security Rating" %}

        div
          img(width=316 height=75 src="{{ chart_url }}")
          p
            | {% if data.show_copyright %}{% trans "Appknox " %}{% endif %}{% trans "Security Rating:" %} {{ rating }}% {% trans "Unsecured" %}

    | {% for analysis in file.sorted_analyses %}

    | {% if analysis.computed_risk > RiskEnum.PASSED and not analysis.is_ignored  %}

    section.new-page
      div
        a(id="{{ analysis.id }}")
        h3.vulnerability-heading
          | {{ analysis.vulnerability.name }}
      section.description
        div
          | {{ analysis.vulnerability.intro | safe }}
        table
          tbody
            tr
              td.risk-tag-container
                div
                  div(class="risk-tag fill-{{ analysis.get_computed_risk_display|lower }}")
                    | {% trans "Risk Rating" %} : {{ analysis.get_computed_risk_display }}
                  | {% if analysis.overridden_risk %}
                  div(class="risk-tag-icon")
                    img(src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCAzOTkuMTQgMzk5LjE0IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAzOTkuMTQgMzk5LjE0OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgd2lkdGg9IjIwcHgiIGhlaWdodD0iMjBweCI+ICAgIDxnPiAgICAgICAgPGNpcmNsZSBjeD0iMTA4Ljc1IiBjeT0iNzIuOTgiIHI9IjYwIiBmaWxsPSIjYzdjN2M3Ii8+ICAgICAgICA8cGF0aCBkPSJNMTkyLjM4OSwyMDIuMjM4Yy0xOS45NDYtMjMuOTg0LTUwLjAwNi0zOS4yNTgtODMuNjM5LTM5LjI1OEM0OC42ODksMTYyLjk4LDAsMjExLjY2OSwwLDI3MS43M2gxMjIuODk3TDE5Mi4zODksMjAyLjIzOHoiIGZpbGw9IiNjN2M3YzciLz4gICAgICAgIDxwYXRoIGQ9Ik0zMDAuMzc2LDEzNi42NzZsMzguNjYxLTM4LjY2MWw2MC4xMDQsNjAuMTA0bC0zOC42NjEsMzguNjYxTDMwMC4zNzYsMTM2LjY3NnoiIGZpbGw9IiNjN2M3YzciLz4gICAgICAgIDxwYXRoIGQ9Ik0xMTAuOTk4LDM4Ni4xNmw2OC40NjQtMTkuOTg2bC00OC40NzgtNDguNDc3TDExMC45OTgsMzg2LjE2eiIgZmlsbD0iI2M3YzdjNyIvPiAgICAgICAgPHBhdGggZD0iTTE0Ni4zODEsMjkwLjY3bDEzMi43ODItMTMyLjc4Mmw2MC4xMDQsNjAuMTA0TDIwNi40ODUsMzUwLjc3NEwxNDYuMzgxLDI5MC42N3oiIGZpbGw9IiNjN2M3YzciLz4gICAgPC9nPjwvc3ZnPg==")
                  | {% endif %}
              td.scan-container
                | {% for type in analysis.vulnerability.get_types_display %}
                span(class="scan-tag")
                  | {{type}}
                | {% endfor %}
      section
        div
          h5.bold-black-text
            | {% trans "Regulatory" %}
        table.regulatory-table
          tbody
            | {% if analysis.show_cvss %}
            tr
              td
                | CVSSv3
              td
                | {{analysis.cvss_base}}

            tr
              td
                | CVSS Metrics
              td
                ul
                  | {% for metric in analysis.cvss_metrics_humanized %}
                  li
                    span.metric-key
                      | {{ metric.key }}
                    span.metric-value
                      | {{ metric.value }}
                  | {% endfor %}
            | {% endif %}
            | {% if analysis.owasp_categories %}
            tr
              td
                | OWASP
              td
                ul
                  | {% for metric in analysis.owasp_categories %}
                  li
                    span.metric-key
                      | {{ metric.code }}
                    span.metric-value
                      | {{ metric.title }}
                  | {% endfor %}
            | {% endif %}
        | {% if analysis.pcidss_categories %}
        div.pcidss-heading
          | PCI-DSS
        | {% for metric in analysis.pcidss_categories %}
        table.pcidss-table
          tbody
            tr
              td.metric-key
                | {{ metric.code }}
              td.metric-value
                div
                  | {{ metric.title }}
                .metric-description
                  | {% trans "Description" %}
                div
                  | {{ metric.description }}
        | {% endfor %}
        | {% endif %}

      section.assessment
        div.analysis-type
          h5
            | {% trans "Risk Assessment" %}
        div
          p
            | {{ analysis.vulnerability.description | safe }}
          | {% for finding in analysis.findings %}
          | {% if finding.title %}
          h2
            | {{ finding.title | escape }}
          | {% endif %}
          pre
            code
              | {{ finding.description | escape }}
          | {% endfor %}

      | {% if analysis.vulnerability.non_compliant %}
      section.non-compliant
        div.analysis-type
          a(id="{{ analysis.id }}{{ forloop.counter }}non-compliant")
          h5
            | {% trans "Noncompliant Code Example" %}
        div
          | {{ analysis.vulnerability.non_compliant | safe }}
      | {% endif %}

      | {% if analysis.vulnerability.compliant %}
      section.compliant
        div.analysis-type
          a(id="{{ analysis.id }}{{ forloop.counter }}compliant")
          h5
            | {% trans "Compliant Solution" %}
        div
          | {{ analysis.vulnerability.compliant | safe }}
      | {% endif %}

      | {% if analysis.vulnerability.business_implication %}
      section.implications
        div.analysis-type
          a(id="{{ analysis.id }}{{ forloop.counter }}business-implication")
          h5
            | {% trans "Business Implication" %}
        div
          | {{ analysis.vulnerability.business_implication | safe }}
      | {% endif %}

      | {% if analysis.vulnerability.related_to %}
      section.related
        div.analysis-type
          a(id="{{ analysis.id }}{{ forloop.counter }}related-to")
          h5
            | {% trans "Related Vulnerabilities" %}
        div
          | {{ analysis.vulnerability.related_to | safe }}
      | {% endif %}

    | {% endif %}
    | {% endfor %}

    | {% if file.guaranteed_profile.rps.show_ignored_analyses and ignored_analyses_count %}
    section.new-page
      div.ignored-analyses
        a(id="ignored-analyses")
        h3.heading-container
          | {% trans "Ignored Analyses" %}

      | {% for analysis in file.sorted_analyses %}
      | {% if analysis.computed_risk > RiskEnum.PASSED and analysis.is_ignored  %}
      section
        div
          a(id="{{ analysis.id }}")
          h3.vulnerability-heading
            | {{ analysis.vulnerability.name }}
        section.description
          div
            | {{ analysis.vulnerability.intro | safe }}
          table
            tbody
              tr
                td.risk-tag-container
                  div
                    div(class="risk-tag fill-{{ analysis.get_computed_risk_display|lower }}")
                      | {% trans "Risk Rating" %} : {{ analysis.get_computed_risk_display }}
                    | {% if analysis.overridden_risk %}
                    div(class="risk-tag-icon")
                      img(src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9IjAgMCAzOTkuMTQgMzk5LjE0IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAzOTkuMTQgMzk5LjE0OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgd2lkdGg9IjIwcHgiIGhlaWdodD0iMjBweCI+ICAgIDxnPiAgICAgICAgPGNpcmNsZSBjeD0iMTA4Ljc1IiBjeT0iNzIuOTgiIHI9IjYwIiBmaWxsPSIjYzdjN2M3Ii8+ICAgICAgICA8cGF0aCBkPSJNMTkyLjM4OSwyMDIuMjM4Yy0xOS45NDYtMjMuOTg0LTUwLjAwNi0zOS4yNTgtODMuNjM5LTM5LjI1OEM0OC42ODksMTYyLjk4LDAsMjExLjY2OSwwLDI3MS43M2gxMjIuODk3TDE5Mi4zODksMjAyLjIzOHoiIGZpbGw9IiNjN2M3YzciLz4gICAgICAgIDxwYXRoIGQ9Ik0zMDAuMzc2LDEzNi42NzZsMzguNjYxLTM4LjY2MWw2MC4xMDQsNjAuMTA0bC0zOC42NjEsMzguNjYxTDMwMC4zNzYsMTM2LjY3NnoiIGZpbGw9IiNjN2M3YzciLz4gICAgICAgIDxwYXRoIGQ9Ik0xMTAuOTk4LDM4Ni4xNmw2OC40NjQtMTkuOTg2bC00OC40NzgtNDguNDc3TDExMC45OTgsMzg2LjE2eiIgZmlsbD0iI2M3YzdjNyIvPiAgICAgICAgPHBhdGggZD0iTTE0Ni4zODEsMjkwLjY3bDEzMi43ODItMTMyLjc4Mmw2MC4xMDQsNjAuMTA0TDIwNi40ODUsMzUwLjc3NEwxNDYuMzgxLDI5MC42N3oiIGZpbGw9IiNjN2M3YzciLz4gICAgPC9nPjwvc3ZnPg==")
                    | {% endif %}
                td.scan-container
                  | {% for type in analysis.vulnerability.get_types_display %}
                  span(class="scan-tag")
                    | {{type}}
                  | {% endfor %}
        section
          div
            h5.bold-black-text
              | {% trans "Regulatory" %}
          table.regulatory-table
            tbody
              | {% if analysis.show_cvss %}
              tr
                td
                  | CVSSv3
                td
                  | {{analysis.cvss_base}}

              tr
                td
                  | CVSS Metrics
                td
                  ul
                    | {% for metric in analysis.cvss_metrics_humanized %}
                    li
                      span.metric-key
                        | {{ metric.key }}
                      span.metric-value
                        | {{ metric.value }}
                    | {% endfor %}
              | {% endif %}
              | {% if analysis.owasp_categories %}
              tr
                td
                  | OWASP
                td
                  ul
                    | {% for metric in analysis.owasp_categories %}
                    li
                      span.metric-key
                        | {{ metric.code }}
                      span.metric-value
                        | {{ metric.title }}
                    | {% endfor %}
              | {% endif %}
          | {% if analysis.pcidss_categories %}
          div.pcidss-heading
            | PCI-DSS
          | {% for metric in analysis.pcidss_categories %}
          table.pcidss-table
            tbody
              tr
                td.metric-key
                  | {{ metric.code }}
                td.metric-value
                  div
                    | {{ metric.title }}
                  .metric-description
                    | {% trans "Description" %}
                  div
                    | {{ metric.description }}
          | {% endfor %}
          | {% endif %}

        section.assessment
          div.analysis-type
            h5
              | {% trans "Risk Assessment" %}
          div
            p
              | {{ analysis.vulnerability.description | safe }}
            | {% for finding in analysis.findings %}
            | {% if finding.title %}
            h2
              | {{ finding.title | escape }}
            | {% endif %}
            pre
              code
                | {{ finding.description | escape }}
            | {% endfor %}

        | {% if analysis.vulnerability.non_compliant %}
        section.non-compliant
          div.analysis-type
            a(id="{{ analysis.id }}{{ forloop.counter }}non-compliant")
            h5
              | {% trans "Noncompliant Code Example" %}
          div
            | {{ analysis.vulnerability.non_compliant | safe }}
        | {% endif %}

        | {% if analysis.vulnerability.compliant %}
        section.compliant
          div.analysis-type
            a(id="{{ analysis.id }}{{ forloop.counter }}compliant")
            h5
              | {% trans "Compliant Solution" %}
          div
            | {{ analysis.vulnerability.compliant | safe }}
        | {% endif %}

        | {% if analysis.vulnerability.business_implication %}
        section.implications
          div.analysis-type
            a(id="{{ analysis.id }}{{ forloop.counter }}business-implication")
            h5
              | {% trans "Business Implication" %}
          div
            | {{ analysis.vulnerability.business_implication | safe }}
        | {% endif %}

        | {% if analysis.vulnerability.related_to %}
        section.related
          div.analysis-type
            a(id="{{ analysis.id }}{{ forloop.counter }}related-to")
            h5
              | {% trans "Related Vulnerabilities" %}
          div
            | {{ analysis.vulnerability.related_to | safe }}
        | {% endif %}

      | {% endif %}
      | {% endfor %}
    | {% endif %}

    section.new-page
      div.references
        a(id="references")
        h3.heading-container
          | {% trans "References" %}
        ol
          a(target="_blank" href="https://www.owasp.org/index.php/Mobile_Top_10_2016-Top_10")
            li
              | Mobile Top 10 OWASP Categories | 2016
          a(target="_blank" href="https://www.owasp.org/index.php/Top_10_2013-Top_10")
            li
              | Web Top 10 OWASP Categories | 2013
