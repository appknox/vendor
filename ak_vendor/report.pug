doctype 5
html(lang="en")
  head
    title= pageTitle
    link(rel='stylesheet' href="https://cdn.rawgit.com/appknox/bohemia/master/dist/bohemia.css")
    link(rel='stylesheet' href="report.css")
  body
    .main-container
      .report-container
        .columns.margin-top20
          .column
            h5
              | confidential
          .column.content-right
            h5
              | 15th February, 2017
        .columns.margin-top50
          .column.align-middle
            img(src='https://raw.githubusercontent.com/appknox/press-kit/master/logo/logo-dark-small.png')
        .columns.margin-top100
          .column.align-middle
            h2.underline
             | Android Security Report
        .columns.margin-top10
          .column.align-middle
            h6.italics
              | For Internal Purpose
        .columns.margin-top50
          .column.align-middle
            h5.bold
              | Prepared For: {{file.name}}
        .columns.margin-top50
          .column
            .mini-container
              p
                | Prepared by XYSec Labs Pte. Ltd. Portions of this document and the templates used in its production are the property of XYSec Labs Pte. Ltd. and cannot be copied without permission.
              p
                | While precautions have been taken in the preparation of this document, XYSec Labs Pte. Ltd., the publisher, and the author(s) assume no responsibility for errors, omissions, or for damages resulting from the use of the information contained herein. Use of XYSec Labs Pte. Ltd. services does not guarantee the security of a system, or that intrusions will not occur.
        .columns
          .column.heading-container.flex-center
              h3
                | Table Of Contents
        .columns
          .column.is-half.margin-auto
            .content-main-table  
              .content-table
                ol.main-heading
                  li
                    a(href="#01")
                      | Report Summary
                  ol.sub-topic
                    li
                      a(href="#02")
                        | Application Details
                    li
                      a(href="#03")
                        | Audit Summary
                    li
                      a(href="#04")
                        | Appknox Security Rating
                    li
                      a(href="#05")
                        | Appknox Findings
              | {% for analysis in file.analyses.all %}
              | {% if analysis.risk > RiskEnum.NONE %}
              .content-table
                ol.main-heading
                  li
                    a(href="#{{ analysis.id }}")
                      | {{ analysis.vulnerability.heading }}
                | {% for subheading in analysis.vulnerability.sub_headings.all %} 
                     
                ol.sub-topic   
                  li
                    a(href="#{{ analysis.id }}{{ forloop.counter }}")
                      | {{ subheading.heading }}
                | {% endfor %} 
                
                | {% if analysis.vulnerability.non_compliant %}
                ol.sub-topic
                  li
                    a(href="#{{ analysis.id }}{{ forloop.counter }}non_compliant")
                      | Noncompliant Code Example
                | {% endif %}       
                
                | {% if analysis.vulnerability.compliant %}
                ol.sub-topic
                  li
                    a(href="#{{ analysis.id }}{{ forloop.counter }}compliant")
                      | Compliant Solution
                | {% endif %}     
                  
                | {% if analysis.vulnerability.related_to %}
                ol.sub-topic
                  li
                    a(href="#{{ analysis.id }}{{ forloop.counter }}related_to")
                      | Related Vulnerabilities
                | {% endif %}    
                   
                | {% if analysis.vulnerability.business_implication %}
                ol.sub-topic
                  li
                    a(href="#{{ analysis.id }}{{ forloop.counter }}business_implication")
                      | Business Implication
                | {% endif %}
              | {% endif %}      
              | {% endfor %}    
                
        .report-summary
          .columns
            .column.heading-container.flex-center
                a(class="link-tag" id="01")
                h3
                  | Report Summary
            p.margin-left30
              | Appknox conducted a security assessment of the mobile application for the Android platform. This report contains all the findings during the automated auditing process. It also contains the process of discovering those vulnerabilities in the first place, and ways to remediate those issues.
          .columns
            .column.sub-heading-container.flex-center
              a(class="link-tag" id="02")
              h5
                | Application Details
          table
            tr
              td
                | Application Name
              td
                | {{file.name}}
            tr
              td
                | Application Namespace
              td
                | {{file.name}}
            tr
              td
                | Version
              td
                | {{file.version}}
            tr
              td
                | Audit Date
              td
                | {{file.updated_on}}
            tr
              td
                | Application SHA1 Hash
              td
                | {{file.sha1hash}}
            tr
              td
                | Application MD5 Hash
              td
                | {{file.md5hash}}

        .columns
          .column.sub-heading-container.flex-center
            a(class="link-tag" id="03")
            h5
              | Audit Summary
        table.audit-table
          | {% for analysis in file.analyses.all %}
          tr
            td
              h5
                | {{ analysis.vulnerability.name }}
              p
                | Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
            td.risk-type(style="color:#F5D76E")
              h5.tag(class="is-warning")
                | {% if analysis.risk == RiskEnum.NONE %}
                | Passed
                | {% else %}
                | {{ analysis.get_risk_display }} Risk
                | {% endif %}
          | {% endfor %}      
                

        .columns
          .column.heading-container.flex-center
              a(class="link-tag" id="07")
              h3
                | Configuration Management
        | {% for analysis in file.analyses.all %}
        .columns
          .column.sub-heading-container.flex-center.bucket-list
            ol
               a(class="link-tag" id="08")
               li
                 | {{ analysis.vulnerability.name }} :
        p.margin-left35
          | {{ analysis.vulnerability.intro | safe }} :
        .columns
          // color changes depending on risk type
          .column.margin-left35.margin-top50.margin-bottom50
            h5.tag.risk-tag(class="is-danger")
              | Risk Rating : High
        .columns
          .column.analysis-type
            a(class="link-tag" id="09")
            h5
              | Risk Assessment
        p.margin-left35.margin-top20
          | The Android application exports Service for use by other applications, but does not properly restrict which applications can launch the component or access the data it contains.
        ul.margin-left50.margin-top20.margin-bottom50
          li
            | Exported service at com.flipkart.accountManager.account.AuthenticatorService
          li
            | Exported service at com.flipkart.accountManager.account.AuthenticatorService
          li
            | Exported service at com.flipkart.accountManager.account.AuthenticatorService

        .columns
          .column.analysis-type
            a(class="link-tag" id="10")
            h5
              | Noncompliant Code Example
        p.margin-left35.margin-top20
          | Using HTTP with SSL or TLS to connect to internet, or without a proper certificate the connection can be easily eavesdropped by attacker without the knowledge of the user.
        pre.pre-code.margin-left50.margin-top20.margin-bottom50
          | String link = "http://www.google.com";

        .columns
          .column.analysis-type
            a(class="link-tag" id="11")
            h5
              | Compliant Solution
        p.margin-left35.margin-top20.margin-bottom50
          | If you are using a Service for sharing data between only your own apps, it is preferable to use the android:protectionLevel attribute set to "signature" protection. Signature permissions do not require user confirmation, so they provide a better user experience and more controlled access to the Service when the apps accessing the data are signed with the same key

        .columns
          .column.analysis-type
            a(class="link-tag" id="12")
            h5
              | Related Vulnerabilities
        p
          ul
            li.margin-left35.margin-top20
              a(href="http://jvn.jp/en/jp/JVN39218538/")
                |JVN#39218538 &nbsp;
              span.margin-bottom50
                | Pizza Hut Japan Official Order App for Android has a problem whereby it fails to verify SSL server certificates.
        | {% endfor %}
