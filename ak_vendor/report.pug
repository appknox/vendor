doctype 5
html(lang="en")
  head
    title= pageTitle
    link(rel='stylesheet' href="https://cdn.rawgit.com/appknox/bohemia/master/dist/bohemia.css")
    link(rel='stylesheet' href="https://cdn.rawgit.com/appknox/vendor/master/ak_vendor/report.css")
  body
    .main-container
      .report-container
        .columns.margin-top20
          .column
            h5
              | confidential
          .column.content-right
            h5
              | 15th February, 2017
        .columns.margin-top50
          .column.align-middle
            img(src='https://raw.githubusercontent.com/appknox/press-kit/master/logo/logo-dark-small.png')
        .columns.margin-top100
          .column.align-middle
            h2.underline
             | Android Security Report
        .columns.margin-top10
          .column.align-middle
            h6.italics
              | For Internal Purpose
        .columns.margin-top50
          .column.align-middle
            h5.bold
              | Prepared For: {{file.name}}
        .columns.margin-top50
          .column
            .mini-container
              p
                | Prepared by XYSec Labs Pte. Ltd. Portions of this document and the templates used in its production are the property of XYSec Labs Pte. Ltd. and cannot be copied without permission.
              p
                | While precautions have been taken in the preparation of this document, XYSec Labs Pte. Ltd., the publisher, and the author(s) assume no responsibility for errors, omissions, or for damages resulting from the use of the information contained herein. Use of XYSec Labs Pte. Ltd. services does not guarantee the security of a system, or that intrusions will not occur.
        .columns
          .column.heading-container.flex-center
              h3
                | Table Of Contents
        .columns
          .column.is-half.margin-auto
            .content-main-table
              .content-table
                ol.main-heading
                  li
                    a(href="#01")
                      | Report Summary
                  ol.sub-topic
                    li
                      a(href="#02")
                        | Application Details
                    li
                      a(href="#03")
                        | Audit Summary
                    li
                      a(href="#04")
                        | Appknox Security Rating

              | {% for analysis in file.analyses.all %}
              | {% if analysis.risk > RiskEnum.NONE %}
              .content-table
                ol.main-heading
                  li
                    a(href="#{{ analysis.id }}")
                      | {{ analysis.vulnerability.heading }}
                | {% for subheading in analysis.vulnerability.sub_headings.all %}

                ol.sub-topic
                  li
                    a(href="#{{ analysis.id }}{{ forloop.counter }}")
                      | {{ subheading.heading }}
                | {% endfor %}

                | {% if analysis.vulnerability.non_compliant %}
                ol.sub-topic
                  li
                    a(href="#{{ analysis.id }}{{ forloop.counter }}non_compliant")
                      | Noncompliant Code Example
                | {% endif %}

                | {% if analysis.vulnerability.compliant %}
                ol.sub-topic
                  li
                    a(href="#{{ analysis.id }}{{ forloop.counter }}compliant")
                      | Compliant Solution
                | {% endif %}

                | {% if analysis.vulnerability.related_to %}
                ol.sub-topic
                  li
                    a(href="#{{ analysis.id }}{{ forloop.counter }}related_to")
                      | Related Vulnerabilities
                | {% endif %}

                | {% if analysis.vulnerability.business_implication %}
                ol.sub-topic
                  li
                    a(href="#{{ analysis.id }}{{ forloop.counter }}business_implication")
                      | Business Implication
                | {% endif %}
              | {% endif %}
              | {% endfor %}

        .report-summary
          .columns
            .column.heading-container.flex-center
                a(class="link-tag" id="01")
                h3
                  | Report Summary
            p.margin-left30
              | Appknox conducted a security assessment of the mobile application for the Android platform. This report contains all the findings during the automated auditing process. It also contains the process of discovering those vulnerabilities in the first place, and ways to remediate those issues.
          .columns
            .column.sub-heading-container.flex-center
              a(class="link-tag" id="02")
              h5
                | Application Details
          table
            tr
              td
                | Application Name
              td
                | {{file.name}}
            tr
              td
                | Application Namespace
              td
                | {{file.name}}
            tr
              td
                | Version
              td
                | {{file.version}}
            tr
              td
                | Audit Date
              td
                | {{file.updated_on}}
            tr
              td
                | Application SHA1 Hash
              td
                | {{file.sha1hash}}
            tr
              td
                | Application MD5 Hash
              td
                | {{file.md5hash}}

        .columns
          .column.sub-heading-container.flex-center
            a(class="link-tag" id="03")
            h5
              | Audit Summary
        table.audit-table
          | {% for analysis in file.analyses.all %}
          tr
            td
              h5
                | {{ analysis.vulnerability.name }}
              p
                | {{ analysis.vulnerability.description }}
            td.risk-type
              h5.tag(style="background-color:{{ analysis.color }};color:#FFF")
                | {% if analysis.risk == RiskEnum.NONE %}
                | Passed
                | {% else %}
                | {{ analysis.get_risk_display }} Risk
                | {% endif %}
          | {% endfor %}

        div.margin-top50
          table.audit-table
            tr
              td
                | Priority Level
              td
                | Number of failed test cases
            tr
              td
                | High Risk
              td
                | {# audit_summary | hash:RiskEnum.HIGH #}
            tr
              td
                | Medium Risk
              td
                | {# audit_summary | hash:RiskEnum.MEDIUM #}
            tr
              td
                | Low Risk
              td
                | {# audit_summary | hash:RiskEnum.LOW #}

        section
          .columns
            .column.sub-heading-container.flex-center
              a(class="link-tag" id="04")
              h5
                | Appknox Security Rating
          div(style="text-align:center" id="logo")
            img(class="images" width=316 height=75 src="{{ chart_url }}")
          p
            | Appknox Security Rating:
            b
              | {# audit_summary | hash:AUDIT_SUMMARY_RATING #}
              | Unsecured

        | {% for analysis in file.analyses.all %}
        | {% if analysis.risk > RiskEnum.NONE %}
        section
          .columns
            .column.heading-container.flex-center
                a(class="link-tag" id="{{ analysis.id }}")
                h3
                  | {{ analysis.vulnerability.heading }}

          .columns
            .column.margin-left35.margin-top50.margin-bottom50
              h5.tag.risk-tag(style="background-color:{{ analysis.color }};color:#FFF")
                | Risk Rating : {{ analysis.get_risk_display }}
          .columns
            .column.analysis-type
              a(class="link-tag" id="09")
              h5
                | Risk Assessment
          p.margin-left35.margin-top20
            | {{ analysis.vulnerability.description | safe }}
          | {% for finding in analysis.findings %}
          | {% if finding.title %}
          p
            | {{ finding.title | safe }}
          | {% endif %}
          pre.pre-code.margin-left50.margin-top20.margin-bottom50
            | {{ finding.description | safe }}
          | {% endfor %}

          | {% for subheading in analysis.vulnerability.sub_headings.all %}
          h3(id="title")
            a(id="{{ analysis.id }}{{ forloop.counter }}")
              | {{ subheading.heading }}
            | {{ subheading.content | safe }}
          | {% endfor %}

          | {% if analysis.vulnerability.non_compliant %}
          .columns
            .column.analysis-type.margin-top50
              a(class="link-tag" id="{{ analysis.id }}{{ forloop.counter }}non_compliant")
              h5
                | Noncompliant Code Example
          .margin-left35.margin-top20
            | {{ analysis.vulnerability.non_compliant | safe }}
          | {% endif %}

          | {% if analysis.vulnerability.compliant %}
          .columns
            .column.analysis-type.margin-top50
              a(class="link-tag" id="{{ analysis.id }}{{ forloop.counter }}compliant")
              h5
                | Compliant Solution
          .margin-left35.margin-top20.margin-bottom50
            | {{ analysis.vulnerability.compliant | safe }}
          | {% endif %}

          | {% if analysis.vulnerability.business_implication %}
          .columns
            .column.analysis-type.margin-top50
              a(class="link-tag" id="{{ analysis.id }}{{ forloop.counter }}related_to")
              h5
                | Related Vulnerabilities
          .margin-left35.margin-top20.margin-bottom50
            | {{ analysis.vulnerability.related_to | safe }}
          | {% endif %}

          | {% if analysis.vulnerability.business_implication %}
          .columns
            .column.analysis-type.margin-top50
              a(class="link-tag" id="{{ analysis.id }}{{ forloop.counter }}business_implication")
              h5
                | Business Implication
          .margin-left35.margin-top20.margin-bottom50
            | {{ analysis.vulnerability.business_implication | safe }}
          | {% endif %}

        | {% endif %}
        | {% endfor %}
