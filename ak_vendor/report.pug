doctype 5
html(lang="en")
  head
    style(type='text/css').
      .new-page {
        page-break-before: always
       }
      @page {
        @top-left { content: "confidential";}
        @top-right { content: "10th April, 2017";}
        @bottom-center {content: "Page " counter(page) " of " counter(pages);}
      }
  body
    section.new-page
      div
        img(src='https://raw.githubusercontent.com/appknox/press-kit/master/logo/logo-dark-small.png')
      div
        h1
          | Android Security Report
      div
        h6
          | For Internal Purpose   
      div
        h5
          | Prepared For: {{file.name}}     
      div
        p
          | Prepared by XYSec Labs Pte. Ltd. Portions of this document and the templates used in its production are the property of XYSec Labs Pte. Ltd. and cannot be copied without permission.
        p
          | While precautions have been taken in the preparation of this document, XYSec Labs Pte. Ltd., the publisher, and the author(s) assume no responsibility for errors, omissions, or for damages resulting from the use of the information contained herein. Use of XYSec Labs Pte. Ltd. services does not guarantee the security of a system, or that intrusions will not occur.      
    
    section.new-page
      div
        h3
          | Table Of Contents
      div
        table
          tbody  
            tr
              td
                a(href="#report-summary")
                  | Report Summary   
            tr
              td
                a(href="#application-details")
                  | Application Details
            tr
              td
                a(href="#audit-summary")
                  | Audit Summary
            tr
              td
                a(href="#security-rating")
                  | Appknox Security Rating
                  
        | {% for analysis in file.analyses.all %}
        | {% if analysis.risk > RiskEnum.NONE %}     
        table 
          tbody  
            tr
              td
                a(href="#{{ analysis.id }}")
                  | {{ analysis.vulnerability.heading }}
            | {% for subheading in analysis.vulnerability.sub_headings.all %}
            tr
              td
                a(href="#{{ analysis.id }}{{ forloop.counter }}")
                  | {{ subheading.heading }}
            | {% endfor %}
            
            | {% if analysis.vulnerability.non_compliant %}
            tr
              td
                a(href="#{{ analysis.id }}{{ forloop.counter }}non-compliant")
                  | Noncompliant Code Example
            | {% endif %}
            
            | {% if analysis.vulnerability.compliant %}
            tr
              td
                a(href="#{{ analysis.id }}{{ forloop.counter }}compliant")
                  | Compliant Solution
            | {% endif %}

            | {% if analysis.vulnerability.business_implication %}
            tr
              td
                a(href="#{{ analysis.id }}{{ forloop.counter }}business-implication")
                  | Business Implication
            | {% endif %}
            
            | {% if analysis.vulnerability.related_to %}
            tr
              td
                a(href="#{{ analysis.id }}{{ forloop.counter }}related-to")
                  | Related Vulnerabilities
            | {% endif %}
            
          | {% endif %}
          | {% endfor %}
          
    section.new-page
      div
        a(id="report-summary")
        h3
          | Report Summary
      div
        p
          | Appknox conducted a security assessment of the mobile application for the Android platform. This report contains all the findings during the automated auditing process. It also contains the process of discovering those vulnerabilities in the first place, and ways to remediate those issues.    
      
      section.details
        div
          a(id="application-details")
          h5
            | Application Details
        div
          table
            tbody
              tr
                td
                  | Application Name
                td
                  | {{file.name}}
              tr
                td
                  | Application Namespace
                td
                  | {{file.name}}
              tr
                td
                  | Version
                td
                  | {{file.version}}
              tr
                td
                  | Audit Date
                td
                  | {{file.updated_on}}
              tr
                td
                  | Application SHA1 Hash
                td
                  | {{file.sha1hash}}
              tr
                td
                  | Application MD5 Hash
                td
                  | {{file.md5hash}}
      
      section.new-page
        div
          a(id="audit-summary")
          h5
            | Audit Summary
        div
          table
            | {% for analysis in file.analyses.all %}
            tbody
              tr
                td
                  h5
                    | {{ analysis.vulnerability.name }}
                  p
                    | {{ analysis.vulnerability.description }}
                td
                  h5(style="background-color:{{ analysis.color }};color:#FFF")
                    | {% if analysis.risk == RiskEnum.NONE %}
                    | Passed
                    | {% else %}
                    | {{ analysis.get_risk_display }} Risk
                    | {% endif %}
            | {% endfor %}    
            
        div
          table
            tbody
              tr
                td
                  | Priority Level
                td
                  | Number of failed test cases
              tr
                td
                  | High Risk
                td
                  | {# audit_summary | hash:RiskEnum.HIGH #}
              tr
                td
                  | Medium Risk
                td
                  | {# audit_summary | hash:RiskEnum.MEDIUM #}
              tr
                td
                  | Low Risk
                td
                  | {# audit_summary | hash:RiskEnum.LOW #}    
                
      section
        div
          a(id="security-rating")
          h5
            | Appknox Security Rating
            
        div
          img(width=316 height=75 src="{{ chart_url }}")
          p
            | Appknox Security Rating:
            b
              | {# audit_summary | hash:AUDIT_SUMMARY_RATING #}
              | Unsecured    
              
          
    | {% for analysis in file.analyses.all %}
    | {% if analysis.risk > RiskEnum.NONE %}
    
    section.new-page
      div
        a(id="{{ analysis.id }}")
        h3
          | {{ analysis.vulnerability.heading }}
      section.description
        div
          | {{ analysis.vulnerability.intro | safe }}
        div
          h5(style="background-color:{{ analysis.color }};color:#FFF")
            | Risk Rating : {{ analysis.get_risk_display }}  
            
      section.assessment
        div
          h5
            | Risk Assessment
        div
          p
            | {{ analysis.vulnerability.description | safe }}
          | {% for descriptions in analysis.description %}
          | {% if descriptions.extra_description %}
          p
            | {{ descriptions.extra_description | safe }}
          | {% endif %}
          pre
            | {{ descriptions.description | safe }}
          | {% endfor %}    
      
      | {% for subheading in analysis.vulnerability.sub_headings.all %}
      section.sub-heading
        div
          h3(id="title")
            a(id="{{ analysis.id }}{{ forloop.counter }}")
              | {{ subheading.heading }}
            | {{ subheading.content | safe }}
      | {% endfor %}
      
      | {% if analysis.vulnerability.non_compliant %}    
      section.non-compliant
        div
          a(id="{{ analysis.id }}{{ forloop.counter }}non-compliant")
          h5
            | Noncompliant Code Example
        div
          | {{ analysis.vulnerability.non_compliant | safe }}
      | {% endif %}
      
      | {% if analysis.vulnerability.compliant %}        
      section.compliant
        div
          a(id="{{ analysis.id }}{{ forloop.counter }}compliant")
          h5
            | Compliant Solution
        div
          | {{ analysis.vulnerability.compliant | safe }}
      | {% endif %}    
      
      | {% if analysis.vulnerability.business_implication %}        
      section.implications
        div
          a(id="{{ analysis.id }}{{ forloop.counter }}business-implication")
          h5
            | Business Implication
        div
          | {{ analysis.vulnerability.business_implication | safe }}   
      | {% endif %}    
      
      | {% if analysis.vulnerability.related_to %}      
      section.related
        div
          a(id="{{ analysis.id }}{{ forloop.counter }}related-to")
          h5
            | Related Vulnerabilities
        div
          | {{ analysis.vulnerability.related_to | safe }}
      | {% endif %}        
        
    | {% endif %}
    | {% endfor %}
